<configuration>
        <logical-systems>
            <name>pe-london</name>
            <interfaces>
                <interface>
                    <name>ge-0/0/1</name>
                    <unit>
                        <name>3</name>
                        <description>pe-london_to_p3-montreal_to_pe-amsterdam (fe-0/0/0)</description>
                        <vlan-id>3</vlan-id>
                        <family>
                            <inet>
                                <address>
                                    <name>10.0.3.6/24</name>
                                </address>
                            </inet>
                            <iso>
                            </iso>
                            <mpls>
                            </mpls>
                        </family>
                    </unit>
                    <unit>
                        <name>12</name>
                        <description>pe-london_to_ce-a2 (fe-0/0/1)</description>
                        <vlan-id>12</vlan-id>
                        <family>
                            <inet>
                                <address>
                                    <name>10.0.12.1/24</name>
                                </address>
                            </inet>
                            <iso>
                            </iso>
                            <mpls>
                            </mpls>
                        </family>
                    </unit>
                    <unit>
                        <name>13</name>
                        <description>pe-london_to_ce-a2 (fe-0/0/1.1)</description>
                        <vlan-id>13</vlan-id>
                        <family>
                            <inet>
                                <address>
                                    <name>10.0.13.1/24</name>
                                </address>
                            </inet>
                            <iso>
                            </iso>
                            <mpls>
                            </mpls>
                        </family>
                    </unit>
                    <unit>
                        <name>92</name>
                        <description>pe-london_to_ce-a2 (fe-0/0/1)</description>
                        <vlan-id>92</vlan-id>
                        <family>
                            <inet>
                                <address>
                                    <name>10.0.92.1/24</name>
                                </address>
                            </inet>
                            <iso>
                            </iso>      
                            <mpls>
                            </mpls>
                        </family>
                    </unit>
                    <unit>
                        <name>93</name>
                        <description>pe-london_to_ce-a2 (fe-0/0/1.1)</description>
                        <vlan-id>93</vlan-id>
                        <family>
                            <inet>
                                <address>
                                    <name>10.0.93.1/24</name>
                                </address>
                            </inet>
                            <iso>
                            </iso>
                            <mpls>
                            </mpls>
                        </family>
                    </unit>
                </interface>
                <interface>
                    <name>lo0</name>
                    <unit>
                        <name>6</name>
                        <family>
                            <inet>
                                <address>
                                    <name>192.168.28.1/32</name>
                                </address>
                            </inet>
                        </family>
                    </unit>
                </interface>
            </interfaces>
            <protocols>
                <rsvp>
                    <interface>
                        <name>all</name>
                    </interface>
                </rsvp>
                <mpls>
                    <label-switched-path>
                        <name>to-tokyo</name>
                        <to>192.168.20.1</to>
                        <no-cspf/>
                    </label-switched-path>
                    <interface>
                        <name>all</name>
                    </interface>
                </mpls>
                <bgp>
                    <description>global description</description>
                    <group>
                        <name>external</name>
                        <type>internal</type>
                        <description>inside group external</description>
                        <multihop>
                            <ttl>15</ttl>
                        </multihop>
                        <local-address>192.168.28.1</local-address>
                        <family>
                            <inet>
                                <unicast>
                                </unicast>
                            </inet>     
                            <inet-vpn>
                                <unicast>
                                </unicast>
                            </inet-vpn>
                        </family>
                        <remove-private>
                        </remove-private>
                        <neighbor>
                            <name>192.168.20.1</name>
                        </neighbor>
                    </group>
                </bgp>
                <ospf>
                    <area>
                        <name>0.0.0.0</name>
                        <interface>
                            <name>ge-0/0/1.3</name>
                        </interface>
                        <interface>
                            <name>lo0.6</name>
                        </interface>
                    </area>
                </ospf>
            </protocols>
            <policy-options>
                <policy-statement>
                    <name>export</name>
                    <term>
                        <name>1</name>
                        <from>
                            <protocol>static</protocol>
                        </from>
                        <then>
                            <community>
                                <add/>
                                <community-name>vpn-target</community-name>
                            </community>
                            <community>
                                <add/>
                                <community-name>ce-a2</community-name>
                            </community>
                            <accept/>
                        </then>
                    </term>
                    <term>
                        <name>2</name>
                        <then>
                            <reject/>
                        </then>
                    </term>
                </policy-statement>
                <policy-statement>
                    <name>export2</name>
                    <term>
                        <name>1</name>
                        <from>
                            <protocol>static</protocol>
                            <route-filter>
                                <address>192.168.61.0/24</address>
                                <orlonger/>
                            </route-filter>
                            <route-filter>
                                <address>172.20.4.0/22</address>
                                <orlonger/>
                            </route-filter>
                        </from>         
                        <then>
                            <community>
                                <add/>
                                <community-name>ce-k2</community-name>
                            </community>
                            <community>
                                <add/>
                                <community-name>vpn2-target</community-name>
                            </community>
                            <accept/>
                        </then>
                    </term>
                    <term>
                        <name>2</name>
                        <then>
                            <reject/>
                        </then>
                    </term>
                </policy-statement>
                <policy-statement>
                    <name>import</name>
                    <term>
                        <name>1</name>
                        <from>
                            <protocol>bgp</protocol>
                            <community>vpn-target</community>
                        </from>
                        <then>
                            <accept/>
                        </then>
                    </term>
                    <term>
                        <name>2</name>
                        <then>
                            <reject/>
                        </then>
                    </term>
                </policy-statement>
                <policy-statement>
                    <name>import2</name>
                    <term>
                        <name>1</name>
                        <from>
                            <protocol>bgp</protocol>
                            <community>vpn2-target</community>
                        </from>
                        <then>
                            <accept/>
                        </then>
                    </term>
                    <term>
                        <name>2</name>
                        <then>
                            <reject/>
                        </then>
                    </term>
                </policy-statement>
                <community>
                    <name>ce-a1</name>
                    <members>origin:192.168.50.1:1</members>
                </community>
                <community>
                    <name>ce-a2</name>
                    <members>origin:192.168.51.1:1</members>
                </community>
                <community>             
                    <name>ce-k1</name>
                    <members>origin:192.168.60.1:1</members>
                </community>
                <community>
                    <name>ce-k2</name>
                    <members>origin:192.168.61.1:1</members>
                </community>
                <community>
                    <name>vpn-target</name>
                    <members>target:65412:100</members>
                </community>
                <community>
                    <name>vpn2-target</name>
                    <members>target:65412:222</members>
                </community>
            </policy-options>
            <routing-instances>
                <instance>
                    <name>vrf</name>
                    <instance-type>vrf</instance-type>
                    <interface>
                        <name>ge-0/0/1.12</name>
                    </interface>
                    <route-distinguisher>
                        <rd-type>192.168.28.1:1</rd-type>
                    </route-distinguisher>
                    <vrf-import>import</vrf-import>
                    <vrf-export>export</vrf-export>
                    <routing-options>
                        <static>
                            <route>
                                <name>192.168.51.0/24</name>
                                <next-hop>10.0.12.2</next-hop>
                            </route>
                            <route>
                                <name>172.16.4.0/22</name>
                                <next-hop>10.0.12.2</next-hop>
                            </route>
                        </static>
                    </routing-options>
                    <protocols>
                        <bgp>
                            <group>
                                <name>external</name>
                                <type>external</type>
                                <family>
                                    <inet>
                                        <unicast>
                                        </unicast>
                                    </inet>
                                    <inet6>
                                        <unicast>
                                        </unicast>
                                    </inet6>
                                </family>
                                <peer-as>65000</peer-as>
                                <neighbor>
                                    <name>10.0.12.2</name>
                                </neighbor>
                            </group>
                        </bgp>
                    </protocols>
                </instance>
                <instance>
                    <name>vrf2</name>
                    <instance-type>vrf</instance-type>
                    <interface>
                        <name>ge-0/0/1.92</name>
                    </interface>
                    <route-distinguisher>
                        <rd-type>192.168.28.1:2</rd-type>
                    </route-distinguisher>
                    <vrf-import>import2</vrf-import>
                    <vrf-export>export2</vrf-export>
                    <routing-options>
                        <static>
                            <route>
                                <name>192.168.61.0/24</name>
                                <next-hop>10.0.92.2</next-hop>
                            </route>
                            <route>
                                <name>172.20.4.0/22</name>
                                <next-hop>10.0.92.2</next-hop>
                            </route>
                        </static>
                    </routing-options>
                </instance>
            </routing-instances>
            <routing-options>
                <autonomous-system>
                    <as-number>65412</as-number>
                </autonomous-system>
            </routing-options>
        </logical-systems>
</configuration>

